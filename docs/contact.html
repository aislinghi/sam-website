<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact - Mr Samir Dowlut</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        #map {
            min-height: 400px;
            background: #f5f5f5;
            position: relative;
        }
        .map-loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f5f5f5;
            color: #666;
            font-size: 1.1rem;
            z-index: 1;
        }
        .map-error {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff0f0;
            color: #666;
            font-size: 1.1rem;
            text-align: center;
            padding: 20px;
            z-index: 2;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="social-links">
            <a href="https://www.linkedin.com/in/samir-dowlut-a712aa140/?originalSubdomain=uk"><i class="fab fa-linkedin"></i></a>
        </div>
        <div class="contact-info">
            <a href="#" class="book-consultation">
                <i class="far fa-clock"></i>
                Book A Consultation
            </a>
            <a href="tel:0117 905 7722" class="phone-number">
                <i class="fas fa-phone"></i>
                0117 905 7722
            </a>
        </div>
    </div>

    <nav class="main-nav">
        <a href="index.html" class="logo">
            <img src="images/samir-dowlut.png" alt="Mr Samir Dowlut" class="profile-image">
            <div class="logo-text">
                <h1>MR SAMIR DOWLUT</h1>
                <p>Ophthalmologist/ Vitreoretinal and Cataract Surgeon</p>
            </div>
        </a>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="cataract.html">Cataract Surgery</a>
            <a href="macula.html">Macula Hole</a>
            <a href="retinal.html">Retinal Detachment</a>
            <a href="treatments.html">Other Treatments</a>
            <a href="about.html">About</a>
            <a href="contact.html" class="active">Contact</a>
            <a href="testimonials.html">Testimonials</a>
        </div>
    </nav>
    
    <div class="container">
        <h1>Contact Information</h1>
        <div class="contact-grid">
            <div class="contact-locations">
                <h2>Clinic Locations</h2>
                <div class="location" data-lat="55.0374" data-lng="-7.2749">
                    <h3>Northwest Independent Hospital</h3>
                    <p><i class="fas fa-map-marker-alt"></i> Church Hill House, Ballykelly, Limavady BT49 9HS</p>
                </div>

                <div class="location" data-lat="54.5973" data-lng="-5.9301">
                    <h3>Cathedral Eye Clinic</h3>
                    <p><i class="fas fa-map-marker-alt"></i> 89-91 Academy St, Belfast BT1 2LS</p>
                </div>

                <div class="location" data-lat="54.4623" data-lng="-6.0834">
                    <h3>Hillsborough Private Clinic</h3>
                    <p><i class="fas fa-map-marker-alt"></i> 2 Main St, Hillsborough BT26 6AE</p>
                </div>

                <div class="location" data-lat="54.3492" data-lng="-6.2700">
                    <h3>Solasta Clinic</h3>
                    <p><i class="fas fa-map-marker-alt"></i> Unit 70, The Boulevard, Banbridge BT32 4LF</p>
                </div>
            </div>
            <div id="map">
                <div class="map-loading">Loading map...</div>
            </div>
        </div>
    </div>

    <script>
        let map;
        let markers = [];

        // Function to show error message
        function showError(message) {
            const mapDiv = document.getElementById('map');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'map-error';
            errorDiv.innerHTML = `
                <div>
                    <p>${message}</p>
                    <p>Please try refreshing the page. If the problem persists, check your internet connection.</p>
                    <button onclick="window.location.reload()" style="margin-top: 10px; padding: 8px 16px; border: none; background: #007bff; color: white; border-radius: 4px; cursor: pointer;">Refresh Page</button>
                </div>
            `;
            mapDiv.appendChild(errorDiv);
        }

        // Function to initialize map
        function initMap() {
            const mapDiv = document.getElementById('map');
            
            // Check if Google Maps API is loaded
            if (!window.google || !window.google.maps) {
                showError('Google Maps failed to load.');
                return;
            }

            try {
                const belfast = { lat: 54.5973, lng: -5.9301 };
                
                map = new google.maps.Map(mapDiv, {
                    zoom: 9,
                    center: belfast,
                    mapTypeControl: false,
                    streetViewControl: false,
                    fullscreenControl: false,
                    gestureHandling: 'cooperative'
                });

                const locations = document.querySelectorAll('.location');
                const bounds = new google.maps.LatLngBounds();

                locations.forEach(location => {
                    const lat = parseFloat(location.dataset.lat);
                    const lng = parseFloat(location.dataset.lng);
                    const title = location.querySelector('h3').textContent;
                    const address = location.querySelector('p').textContent;
                    
                    if (isNaN(lat) || isNaN(lng)) {
                        console.error('Invalid coordinates for location:', title);
                        return;
                    }

                    const position = { lat, lng };
                    const marker = new google.maps.Marker({
                        position,
                        map,
                        title,
                        animation: google.maps.Animation.DROP
                    });

                    bounds.extend(position);
                    markers.push(marker);

                    const infowindow = new google.maps.InfoWindow({
                        content: `<div class="info-window"><h4>${title}</h4><p>${address}</p></div>`
                    });

                    marker.addListener('click', () => {
                        markers.forEach(m => m.setAnimation(null));
                        marker.setAnimation(google.maps.Animation.BOUNCE);
                        setTimeout(() => marker.setAnimation(null), 750);
                        infowindow.open(map, marker);
                    });

                    location.addEventListener('click', () => {
                        markers.forEach(m => m.setAnimation(null));
                        marker.setAnimation(google.maps.Animation.BOUNCE);
                        setTimeout(() => marker.setAnimation(null), 750);
                        map.panTo(position);
                        map.setZoom(15);
                        infowindow.open(map, marker);
                    });
                });

                if (markers.length > 0) {
                    map.fitBounds(bounds);
                    google.maps.event.addListenerOnce(map, 'idle', () => {
                        if (map.getZoom() > 12) map.setZoom(12);
                    });
                }

                // Remove loading message if map loads successfully
                const loadingDiv = mapDiv.querySelector('.map-loading');
                if (loadingDiv) {
                    loadingDiv.remove();
                }
            } catch (error) {
                console.error('Error initializing map:', error);
                showError('Error initializing the map.');
            }
        }

        // Load Google Maps API
        window.initMap = initMap;  // Make initMap global

        // Add error event listener before loading the script
        window.gm_authFailure = function() {
            showError('Google Maps authentication failed. Please check your API key.');
        };

        // Load the Maps API script
        (function loadGoogleMaps() {
            const script = document.createElement('script');
            script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyDvHEnXQby9FWF7S_CvcQqU1jPJvFa6dlw&callback=initMap';
            script.async = true;
            script.defer = true;
            script.onerror = () => showError('Failed to load Google Maps.');
            document.head.appendChild(script);
        })();
    </script>
</body>
</html> 